( MicroCore TM uForth )
decimal

: any
0
;

INITIALISED

Create _sigma
 0
 ,
 1
 ,
 2
 ,
 3
 ,
 4
 ,
 5
 ,
 6
 ,
 7
 ,
 8
 ,
 9
 ,
 10
 ,
 11
 ,
 12
 ,
 13
 ,
 14
 ,
 15
 ,
 14
 ,
 10
 ,
 4
 ,
 8
 ,
 9
 ,
 15
 ,
 13
 ,
 6
 ,
 1
 ,
 12
 ,
 0
 ,
 2
 ,
 11
 ,
 7
 ,
 5
 ,
 3
 ,
 11
 ,
 8
 ,
 12
 ,
 0
 ,
 5
 ,
 2
 ,
 15
 ,
 13
 ,
 10
 ,
 14
 ,
 3
 ,
 6
 ,
 7
 ,
 1
 ,
 9
 ,
 4
 ,
 7
 ,
 9
 ,
 3
 ,
 1
 ,
 13
 ,
 12
 ,
 11
 ,
 14
 ,
 2
 ,
 6
 ,
 5
 ,
 10
 ,
 4
 ,
 0
 ,
 15
 ,
 8
 ,
 9
 ,
 0
 ,
 5
 ,
 7
 ,
 2
 ,
 4
 ,
 10
 ,
 15
 ,
 14
 ,
 1
 ,
 11
 ,
 12
 ,
 6
 ,
 8
 ,
 3
 ,
 13
 ,
 2
 ,
 12
 ,
 6
 ,
 10
 ,
 0
 ,
 11
 ,
 8
 ,
 3
 ,
 4
 ,
 13
 ,
 7
 ,
 5
 ,
 15
 ,
 14
 ,
 1
 ,
 9
 ,
 12
 ,
 5
 ,
 1
 ,
 15
 ,
 14
 ,
 13
 ,
 4
 ,
 10
 ,
 0
 ,
 7
 ,
 6
 ,
 3
 ,
 9
 ,
 2
 ,
 8
 ,
 11
 ,
 13
 ,
 11
 ,
 7
 ,
 14
 ,
 12
 ,
 1
 ,
 3
 ,
 9
 ,
 5
 ,
 0
 ,
 15
 ,
 4
 ,
 8
 ,
 6
 ,
 2
 ,
 10
 ,
 6
 ,
 15
 ,
 14
 ,
 9
 ,
 11
 ,
 3
 ,
 0
 ,
 8
 ,
 12
 ,
 2
 ,
 13
 ,
 7
 ,
 1
 ,
 4
 ,
 10
 ,
 5
 ,
 10
 ,
 2
 ,
 8
 ,
 4
 ,
 7
 ,
 6
 ,
 1
 ,
 5
 ,
 15
 ,
 11
 ,
 9
 ,
 14
 ,
 3
 ,
 12
 ,
 13
 ,
 0
 ,
 0
 ,
 1
 ,
 2
 ,
 3
 ,
 4
 ,
 5
 ,
 6
 ,
 7
 ,
 8
 ,
 9
 ,
 10
 ,
 11
 ,
 12
 ,
 13
 ,
 14
 ,
 15
 ,
 14
 ,
 10
 ,
 4
 ,
 8
 ,
 9
 ,
 15
 ,
 13
 ,
 6
 ,
 1
 ,
 12
 ,
 0
 ,
 2
 ,
 11
 ,
 7
 ,
 5
 ,
 3
 ,
 11
 ,
 8
 ,
 12
 ,
 0
 ,
 5
 ,
 2
 ,
 15
 ,
 13
 ,
 10
 ,
 14
 ,
 3
 ,
 6
 ,
 7
 ,
 1
 ,
 9
 ,
 4
 ,
 7
 ,
 9
 ,
 3
 ,
 1
 ,
 13
 ,
 12
 ,
 11
 ,
 14
 ,
 2
 ,
 6
 ,
 5
 ,
 10
 ,
 4
 ,
 0
 ,
 15
 ,
 8
 ,
 9
 ,
 0
 ,
 5
 ,
 7
 ,
 2
 ,
 4
 ,
 10
 ,
 15
 ,
 14
 ,
 1
 ,
 11
 ,
 12
 ,
 6
 ,
 8
 ,
 3
 ,
 13
 ,
 2
 ,
 12
 ,
 6
 ,
 10
 ,
 0
 ,
 11
 ,
 8
 ,
 3
 ,
 4
 ,
 13
 ,
 7
 ,
 5
 ,
 15
 ,
 14
 ,
 1
 ,
 9
 ,
 12
 ,
 5
 ,
 1
 ,
 15
 ,
 14
 ,
 13
 ,
 4
 ,
 10
 ,
 0
 ,
 7
 ,
 6
 ,
 3
 ,
 9
 ,
 2
 ,
 8
 ,
 11
 ,
 13
 ,
 11
 ,
 7
 ,
 14
 ,
 12
 ,
 1
 ,
 3
 ,
 9
 ,
 5
 ,
 0
 ,
 15
 ,
 4
 ,
 8
 ,
 6
 ,
 2
 ,
 10
 ,
 6
 ,
 15
 ,
 14
 ,
 9
 ,
 11
 ,
 3
 ,
 0
 ,
 8
 ,
 12
 ,
 2
 ,
 13
 ,
 7
 ,
 1
 ,
 4
 ,
 10
 ,
 5
 ,
 10
 ,
 2
 ,
 8
 ,
 4
 ,
 7
 ,
 6
 ,
 1
 ,
 5
 ,
 15
 ,
 11
 ,
 9
 ,
 14
 ,
 3
 ,
 12
 ,
 13
 ,
 0
 ,

Create _c32
 608135816
 ,
 -2052912941
 ,
 320440878
 ,
 57701188
 ,
 -1542899678
 ,
 698298832
 ,
 137296536
 ,
 -330404727
 ,
 1160258022
 ,
 953160567
 ,
 -1101764913
 ,
 887688300
 ,
 -1062458953
 ,
 -914599715
 ,
 1065670069
 ,
 -1253635817
 ,

Create _padding
 128
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,

Create _IV256
 1779033703
 ,
 -1150833018
 ,
 1013904242
 ,
 -1521486539
 ,
 1359893119
 ,
 -1694144372
 ,
 528734635
 ,
 1541459225
 ,

UNINITIALISED

: _G32
( 8 parameters ) 
0
>r
rsp@
12
-
rsp! ( allocate 12 local variables )
12
l!
11
l!
10
l!
9
l!
8
l!
-rot
dup
7
l!
swap
dup
11
l@
+
9
l@
1
shift
6
l!
10
l@
6
shift
_sigma
2
Rot32
+
-2
Rot32
5
l!
-rot
2over
nip
@
rot
11
l@
+
@
+
6
l@
tuck
5
l@
+
@
12
l@
+
@
rot
1+
5
l@
+
@
_c32
+
@
xor
+
rot
!
8
l@
11
l@
tuck
+
dup
4
l!
@
2over
nip
rot
+
@
xor
16
ROT32
-rot
rot
4
l@
!
over
11
l@
tuck
+
tuck
@
8
l@
2over
nip
+
@
+
rot
!
7
l@
swap
+
dup
3
l!
@
2over
nip
11
l@
+
@
xor
20
ROT32
-rot
rot
3
l@
!
dup
11
l@
tuck
+
9
l@
1
shift
2
l!
10
l@
6
shift
_sigma
2
Rot32
+
-2
Rot32
1
l!
tuck
@
7
l@
2over
nip
+
@
+
2
l@
tuck
1+
1
l@
+
@
12
l@
+
@
rot
1
l@
+
@
_c32
+
@
xor
+
rot
!
8
l@
swap
+
-rot
2over
nip
@
swap
11
l@
+
@
xor
24
ROT32
-rot
rot
rot
!
11
l@
+
dup
@
8
l@
11
l@
+
@
+
swap
!
Label lbl_3

rsp@
12
+
rsp!
rdrop ( deallocate 12 local variables )
;

: _compress32
( 2 parameters ) 
0
>r
rsp@
33
-
rsp! ( allocate 33 local variables )
swap
over
@
2
l!
over
1+
@
3
l!
over
2
+
@
4
l!
over
3
+
@
5
l!
over
4
+
@
6
l!
over
5
+
@
7
l!
over
6
+
@
8
l!
over
7
+
@
9
l!
over
8
+
@
10
l!
over
9
+
@
11
l!
over
10
+
@
12
l!
over
11
+
@
13
l!
over
12
+
@
14
l!
over
13
+
@
15
l!
over
14
+
@
16
l!
swap
15
+
@
17
l!
dup
4
+
@
18
l!
dup
5
+
@
19
l!
dup
6
+
@
20
l!
dup
7
+
@
21
l!
dup
8
+
@
22
l!
dup
9
+
@
23
l!
dup
10
+
@
24
l!
dup
11
+
@
25
l!
dup
30
+
@
_c32
@
xor
26
l!
dup
31
+
@
_c32
1
+
@
xor
27
l!
dup
32
+
@
_c32
2
+
@
xor
28
l!
dup
33
+
@
_c32
3
+
@
xor
29
l!
dup
3
+
@
0
-
0=
?GOTO lbl_34 ( jump if equal )
_c32
4
+
@
30
l!
_c32
5
+
@
31
l!
_c32
6
+
@
32
l!
_c32
7
+
@
33
l!
GOTO lbl_35
Label lbl_34
dup
12
+
@
_c32
4
+
@
xor
30
l!
dup
12
+
@
_c32
5
+
@
xor
31
l!
dup
13
+
@
_c32
6
+
@
xor
32
l!
dup
13
+
@
_c32
7
+
@
xor
33
l!
Label lbl_35
0
GOTO lbl_55
Label lbl_52
1
l!
0
4
8
12
0
1
l@
rsp@
17
+
rsp@
1
+
_G32
1
5
9
13
1
1
l@
rsp@
17
+
rsp@
1
+
_G32
2
6
10
14
2
1
l@
rsp@
17
+
rsp@
1
+
_G32
3
7
11
15
3
1
l@
rsp@
17
+
rsp@
1
+
_G32
0
5
10
15
4
1
l@
rsp@
17
+
rsp@
1
+
_G32
1
6
11
12
5
1
l@
rsp@
17
+
rsp@
1
+
_G32
2
7
8
13
6
1
l@
rsp@
17
+
rsp@
1
+
_G32
3
4
9
14
7
1
l@
rsp@
17
+
rsp@
1
+
_G32
Label lbl_53
1
l@
1+
Label lbl_55
dup
12
u<
?GOTO lbl_52 ( jump if less )
drop
dup
4
+
swap
over
@
18
l@
26
l@
xor
2over
nip
30
+
@
xor
xor
rot
!
dup
5
+
swap
over
@
19
l@
27
l@
xor
2over
nip
31
+
@
xor
xor
rot
!
dup
6
+
swap
over
@
20
l@
28
l@
xor
2over
nip
32
+
@
xor
xor
rot
!
dup
7
+
swap
over
@
21
l@
29
l@
xor
2over
nip
33
+
@
xor
xor
rot
!
dup
8
+
swap
over
@
22
l@
30
l@
xor
2over
nip
30
+
@
xor
xor
rot
!
dup
9
+
swap
over
@
23
l@
31
l@
xor
2over
nip
31
+
@
xor
xor
rot
!
dup
10
+
swap
over
@
24
l@
32
l@
xor
2over
nip
32
+
@
xor
xor
rot
!
dup
11
+
swap
over
@
25
l@
33
l@
xor
rot
33
+
@
xor
xor
swap
!
0
( return int )
Label lbl_4

rsp@
33
+
rsp!
rdrop ( deallocate 33 local variables )
;

: _Init
( 2 parameters ) 
swap
over
256
-
?GOTO lbl_72 ( jump if not equal )
0
GOTO lbl_77
Label lbl_74
swap
over
2
Rot32
dup
_IV256
2
Rot32
+
-2
Rot32
@
swap
2over
nip
4
+
2
Rot32
+
-2
Rot32
!
Label lbl_75
swap
1+
swap
swap
Label lbl_77
dup
8
u<
?GOTO lbl_74 ( jump if less )
drop
0
over
12
+
!
0
over
13
+
!
0
GOTO lbl_81
Label lbl_78
swap
0
2over
nip
2over
nip
14
+
+
!
Label lbl_79
swap
1+
swap
swap
Label lbl_81
dup
16
u<
?GOTO lbl_78 ( jump if less )
drop
0
over
30
+
!
0
over
31
+
!
0
over
32
+
!
0
over
33
+
!
GOTO lbl_73
Label lbl_72
2
Rot32
drop
drop
2
( return int )
GOTO lbl_71
Label lbl_73
swap
over
!
0
over
1+
!
1
over
2
+
!
0
swap
3
+
!
0
( return int )
Label lbl_71
;

: _AddSalt
( 2 parameters ) 
swap
dup
2
+
@
1
-
0=
?GOTO lbl_83 ( jump if equal )
2
Rot32
drop
2
Rot32
drop
1
( return int )
GOTO lbl_82
Label lbl_83
over
@
over
30
+
!
over
1+
@
over
31
+
!
over
2
+
@
over
32
+
!
swap
3
+
@
swap
33
+
!
0
( return int )
Label lbl_82
;

: _Update32
( 3 parameters ) 
0
>r
rsp@
8
-
rsp! ( allocate 8 local variables )
-rot
swap
2over
nip
0
-
?GOTO lbl_86 ( jump if not equal )
dup
1+
@
512
-
0=
?GOTO lbl_86 ( jump if equal )
2
Rot32
drop
2
Rot32
drop
drop
0
( return int )
GOTO lbl_85
Label lbl_86
dup
1+
@
3
negate
shift
dup
8
l!
dup
2
negate
shift
dup
7
l!
64
2over
nip
-
6
l!
16
swap
-
5
l!
0
-
0=
?GOTO lbl_97 ( jump if equal )
2over
nip
3
negate
shift
63
and
6
l@
swap
swap
u<
?GOTO lbl_97 ( jump if less )
0
swap
GOTO lbl_93
Label lbl_90
swap
dup
4
l!
2over
nip
+
@
7
l@
4
l@
+
2over
nip
14
+
+
!
Label lbl_91
4
l@
1+
swap
Label lbl_93
over
5
l@
swap
swap
u<
?GOTO lbl_90 ( jump if less )
swap
drop
dup
12
+
tuck
@
512
+
rot
!
dup
12
+
@
0
-
?GOTO lbl_94 ( jump if not equal )
dup
13
+
tuck
@
1+
rot
!
Label lbl_94
dup
over
14
+
_compress32
drop
5
l@
rot
+
swap
rot
6
l@
2*
2
Rot32
-
-rot
0
8
l!
0
7
l!
GOTO lbl_97
Label lbl_96
dup
12
+
tuck
@
512
+
rot
!
dup
12
+
@
0
-
?GOTO lbl_99 ( jump if not equal )
dup
13
+
tuck
@
1+
rot
!
Label lbl_99
dup
2over
nip
_compress32
drop
swap
16
+
swap
rot
512
-
-rot
Label lbl_97
2over
nip
512
u<
0=
?GOTO lbl_96 ( jump if greater or equal )
2over
nip
0
-
0=
?GOTO lbl_101 ( jump if equal )
rot
dup
2
l!
5
negate
shift
3
l!
0
swap
GOTO lbl_106
Label lbl_103
swap
dup
4
l!
2over
nip
+
@
7
l@
4
l@
+
2over
nip
14
+
+
!
Label lbl_104
4
l@
1+
swap
Label lbl_106
over
3
l@
swap
swap
u<
?GOTO lbl_103 ( jump if less )
swap
drop
8
l@
2*
2
Rot32
2
l@
-rot
2over
nip
+
over
1+
!
swap
1
and
1
l!
7
l@
-rot
1
l@
0
-
0=
?GOTO lbl_102 ( jump if equal )
3
l@
rot
+
@
rot
3
l@
+
rot
14
+
+
!
any
any
any
GOTO lbl_102
Label lbl_101
swap
2
Rot32
drop
swap
drop
0
swap
1+
!
any
any
any
Label lbl_102
2
Rot32
drop
2
Rot32
drop
drop
0
( return int )
Label lbl_85

rsp@
8
+
rsp!
rdrop ( deallocate 8 local variables )
;

: _Update
( 3 parameters ) 
-rot
swap
swap
rot
_Update32
( return int )
Label lbl_109
;

: _Final32
( 2 parameters ) 
0
>r
rsp@
7
-
rsp! ( allocate 7 local variables )
swap
0
5
l!
128
4
l!
dup
1+
dup
3
l!
over
12
+
@
swap
@
+
-rot
dup
13
+
@
2
l!
2over
nip
3
l@
@
swap
swap
u<
0=
?GOTO lbl_111 ( jump if greater or equal )
2
l@
1+
2
l!
Label lbl_111
2
l@
6
l!
rot
7
l!
dup
1+
@
31
and
0
-
?GOTO lbl_114 ( jump if not equal )
dup
1+
@
416
-
?GOTO lbl_116 ( jump if not equal )
dup
12
+
dup
@
32
-
swap
!
dup
rsp@
3
+
32
_Update32
drop
GOTO lbl_117
Label lbl_116
dup
1+
@
416
u<
0=
?GOTO lbl_118 ( jump if greater or equal )
dup
1+
@
0
-
?GOTO lbl_120 ( jump if not equal )
1
over
3
+
!
Label lbl_120
dup
1
l!
dup
12
+
-rot
2over
nip
@
416
rot
1+
@
-
-
rot
!
1
l@
_padding
416
1
l@
1+
@
-
_Update32
drop
1
l@
GOTO lbl_119
Label lbl_118
dup
1
l!
dup
12
+
-rot
2over
nip
@
512
rot
1+
@
-
-
rot
!
1
l@
_padding
512
1
l@
1+
@
-
_Update32
drop
1
l@
tuck
12
+
swap
over
@
416
-
rot
!
swap
_padding
1
+
416
_Update32
drop
1
1
l@
tuck
3
+
!
Label lbl_119
dup
rsp@
4
+
32
_Update32
drop
dup
12
+
dup
@
32
-
swap
!
Label lbl_117
dup
12
+
dup
@
64
-
swap
!
dup
rsp@
5
+
64
_Update32
drop
GOTO lbl_115
Label lbl_114
2
Rot32
drop
2
Rot32
drop
1
( return int )
GOTO lbl_110
Label lbl_115
dup
4
+
@
2over
nip
!
dup
5
+
@
2over
nip
1+
!
dup
6
+
@
2over
nip
2
+
!
dup
7
+
@
2over
nip
3
+
!
dup
8
+
@
2over
nip
4
+
!
dup
9
+
@
2over
nip
5
+
!
dup
10
+
@
2over
nip
6
+
!
11
+
@
swap
7
+
!
0
( return int )
Label lbl_110

rsp@
7
+
rsp!
rdrop ( deallocate 7 local variables )
;

: _Final
( 2 parameters ) 
swap
swap
_Final32
( return int )
Label lbl_123
;

: _Hash
( 4 parameters ) 
0
>r
rsp@
35
-
rsp! ( allocate 35 local variables )
1
l!
-rot
swap
rsp@
1
+
swap
_Init
-rot
rot
dup
0
-
0=
?GOTO lbl_125 ( jump if equal )
swap
2
Rot32
drop
swap
drop
( return int )
GOTO lbl_124
Label lbl_125
drop
rsp@
1
+
swap
rot
_Update
dup
1
l@
-rot
0
-
0=
?GOTO lbl_127 ( jump if equal )
swap
2
Rot32
drop
( return int )
GOTO lbl_124
Label lbl_127
drop
rsp@
1
+
swap
_Final
( return int )
Label lbl_124

rsp@
35
+
rsp!
rdrop ( deallocate 35 local variables )
;


INITIALISED

Create x_130
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,
 0
 ,

Create x_131
 0
 ,

UNINITIALISED

: _doHash
( 0 parameters ) 
0
>r
rsp@
9
-
rsp! ( allocate 9 local variables )
x_130
rsp@
1
+
7
+
>r
6
FOR
ld
1+
NEXT
@
r>
6
FOR
st
1-
NEXT
!
x_131
rsp@
0
+
>r
@
r>
!
256
rsp@
32
rsp@
1
+
_Hash
drop
2
l@
( Cast to int )
-982381698
-
0=
?GOTO lbl_132 ( jump if equal )
2
l@
CALL _print ( call to function )
Label lbl_132
3
l@
( Cast to int )
-2121089329
-
0=
?GOTO lbl_134 ( jump if equal )
3
l@
CALL _print ( call to function )
Label lbl_134
4
l@
( Cast to int )
1245703973
-
0=
?GOTO lbl_138 ( jump if equal )
4
l@
CALL _print ( call to function )
Label lbl_138
5
l@
( Cast to int )
-826073058
-
0=
?GOTO lbl_142 ( jump if equal )
5
l@
CALL _print ( call to function )
Label lbl_142
6
l@
( Cast to int )
-672156309
-
0=
?GOTO lbl_146 ( jump if equal )
6
l@
CALL _print ( call to function )
Label lbl_146
7
l@
( Cast to int )
1912226000
-
0=
?GOTO lbl_150 ( jump if equal )
7
l@
CALL _print ( call to function )
Label lbl_150
8
l@
( Cast to int )
1635361011
-
0=
?GOTO lbl_154 ( jump if equal )
8
l@
CALL _print ( call to function )
Label lbl_154
9
l@
( Cast to int )
1338489291
-
0=
?GOTO lbl_158 ( jump if equal )
9
l@
CALL _print ( call to function )
Label lbl_158
2
l@
( return uint )
Label lbl_129

rsp@
9
+
rsp!
rdrop ( deallocate 9 local variables )
;

